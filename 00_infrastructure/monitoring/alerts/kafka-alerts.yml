groups:
  - name: kafka
    rules:
      - alert: KafkaBrokerDown
        expr: kafka_up == 0
        for: 1m
        labels:
          severity: critical
          service: kafka
        annotations:
          summary: "Kafka broker is down"
          description: "Kafka broker {{ $labels.instance }} has been down for more than 1 minute"
          
      - alert: KafkaUnderReplicatedPartitions
        expr: kafka_topic_partition_under_replicated_partition > 0
        for: 2m
        labels:
          severity: warning
          service: kafka
        annotations:
          summary: "Kafka has under-replicated partitions"
          description: "Kafka has {{ $value }} under-replicated partitions"
          
      - alert: HighConsumerLag
        expr: kafka_consumer_lag > 10000
        for: 5m
        labels:
          severity: warning
          service: kafka
        annotations:
          summary: "High Kafka consumer lag detected"
          description: "Consumer {{ $labels.consumer_group }} has lag of {{ $value }} messages"